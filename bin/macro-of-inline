#!/usr/bin/env python

import sys
import argparse

from macro_of_inline import rewrite_file

parser = argparse.ArgumentParser(version="0.9", description="C Preprocessor to translate inline functions to equivalent macros")
parser.add_argument("i", metavar="INFILE", help="input filename. It does _not_ need to be preprocessed")
parser.add_argument("-o", metavar="OUTFILE", help="output (default:-)", default="-")
args = parser.parse_args()

runner = rewrite_file.RewriteFileContents(args.i)
output_txt = runner.run()

if args.o == "-":
	sys.stdout.write(output_txt)
else:
	f = open(args.o, "w")
	f.write(output_txt)
	f.close()
